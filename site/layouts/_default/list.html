{{- define "main" }}
  {{- $guidePage := .Site.GetPage "/guide" }}
  {{- $isComingSoon := and $guidePage $guidePage.Date (lt now $guidePage.Date) (eq hugo.Environment "production") }}
  <section class="container my-5">
    <div class="row">
      <div class="col-12">
        <h1 class="mb-4">Download the official {{ $guidePage.Title }}</h1>

        <p class="lead mb-4">
          {{ $guidePage.Title }} is defined here by
          {{- $creators := .Site.GetPage "/creators" }}
          {{- $creatorPages := $creators.Pages }}
          {{- range $index, $creator := $creatorPages }}
            {{- if $index }},{{ end }}
            {{- if gt (len $creatorPages) 1 }}{{ if eq $index (sub (len $creatorPages) 1) }}&nbsp;and{{ end }}{{ end }}
            <a href="{{ $creator.Permalink }}" class="text-decoration-none">{{ $creator.Title }}</a>
          {{- end }}
          , the originators of the {{ $guidePage.Title }}.
        </p>

        <p class="mb-4">Translations provided by the generous individuals and groups listed below. Please select the guide in the language you would like to download.</p>

        <p class="mb-5">If you have found a possible translation error with the {{ $guidePage.Title }} please contact the translator directly. If you need additional support please contact {{ .Site.Params.supportEmail }}</p>

        <!-- Official Version -->
        <h2 class="mb-3">Official Version</h2>
        <div class="table-responsive mb-5">
          <table class="table table-striped">
            <thead>
              <tr>
                <th scope="col">Language</th>
                <th scope="col">Translations By</th>
                <th scope="col">Action</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>English ({{ $guidePage.Date.Format "January 2006" }}) - Official Current Version</td>
                <td>
                  {{- $creators := .Site.GetPage "/creators" }}
                  {{- $creatorPages := $creators.Pages }}
                  {{- range $index, $creator := $creatorPages }}
                    {{- if $index }},{{ end }}
                    {{- if gt (len $creatorPages) 1 }}{{ if eq $index (sub (len $creatorPages) 1) }}&{{ end }}{{ end }}
                    <a href="{{ $creator.Permalink }}" class="text-decoration-none">{{ $creator.Title }}</a>
                  {{- end }}
                </td>
                <td>
                  {{ if $isComingSoon }}
                    <a href="#" class="btn btn-primary disabled">Coming Soon</a>
                  {{ else }}
                    <a href="/pdf/{{ $guidePage.Title }}.en.pdf" class="btn btn-primary btn-sm" download> <i class="fa-solid fa-download me-1"></i>Download </a>
                  {{ end }}
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Community Translations -->
        <h2 class="mb-3">Community Translations</h2>
        <p class="text-muted mb-3">
          <small>
            * - The current official version of the Scrum Guide was released in {{ $guidePage.Date.Format "January 2006" }}. Translations of the Scrum Guide with older dates may not contain the most recent information. Please navigate to the Scrum Guide
            Revision History page to see the major changes.
          </small>
        </p>

        <div class="table-responsive">
          <table class="table table-striped">
            <thead>
              <tr>
                <th scope="col">Language</th>
                <th scope="col">Translations By</th>
                <th scope="col">Action</th>
              </tr>
            </thead>
            <tbody>
              {{- range .Site.Languages }}
                {{- if ne .Lang "en" }}
                  {{- $guidePage := $.Site.GetPage (printf "/%s/guide" .Lang) }}
                  <tr>
                    <td>
                      {{ .LanguageName }}
                      {{- if $guidePage }}
                        {{- if $guidePage.Date }}
                          ({{ $guidePage.Date.Format "January 2006" }})
                        {{- else }}
                          {{- $mainGuidePage := $.Site.GetPage "/guide" }}
                          ({{ $mainGuidePage.Date.Format "January 2006" }})
                        {{- end }}
                      {{- else }}
                        {{- $mainGuidePage := $.Site.GetPage "/guide" }}
                        ({{ $mainGuidePage.Date.Format "January 2006" }})
                      {{- end }}
                    </td>
                    <td>
                      {{- if $guidePage.Params.contributors }}
                        {{- range $index, $contributor := $guidePage.Params.contributors }}
                          {{- if $index }},{{ end }}
                          {{- if $contributor.link }}
                            <a href="{{ $contributor.link }}" target="_blank" rel="noopener" class="text-decoration-none">
                              {{ $contributor.name }}
                              <i class="fa-solid fa-external-link-alt ms-1"></i>
                            </a>
                          {{- else }}
                            {{ $contributor.name }}
                          {{- end }}
                        {{- end }}
                      {{- else }}
                        Community Contributors
                      {{- end }}
                    </td>
                    <td>
                      <a href="/pdf/scrum-guide.{{ .Lang }}.pdf" class="btn btn-primary btn-sm" download> <i class="fa-solid fa-download me-1"></i>Download </a>
                    </td>
                  </tr>
                {{- end }}
              {{- end }}
              <!-- Add Translation Row -->
              <tr class="table-light">
                <td colspan="2"><strong>Missing your language?</strong> Help the community by contributing a new translation.</td>
                <td>
                  <a href="https://github.com/nkdAgility/ScrumGuide-ExpansionPack/issues/new?template=new-translation.yml" class="btn btn-outline-primary btn-sm" target="_blank" rel="noopener"> <i class="fa-solid fa-plus me-1"></i>Add Translation </a>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </section>
{{- end }}
{{- define "template" }}
  _default/list.html
{{- end }}
